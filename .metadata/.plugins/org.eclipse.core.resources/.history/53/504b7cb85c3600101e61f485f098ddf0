package thw.edu.javaII.port.warehouse.ui.model;

import java.util.ArrayList;
import java.util.List;

import javax.swing.table.AbstractTableModel;

import thw.edu.javaII.port.warehouse.model.Bestellung;
import thw.edu.javaII.port.warehouse.model.BestellungProdukt;

public class BestellungTableModel extends AbstractTableModel {
    private static final long serialVersionUID = 1L;
    private List<BestellungProduktEntry> entries;
    private String[] columnNames = { "ID", "Kunde ID", "Produkt ID","Produktname", "Menge", "Datum" };

    // Hilfsklasse, um Bestellung und BestellungProdukt zu koppeln
    private static class BestellungProduktEntry {
        private Bestellung bestellung;
        private BestellungProdukt produkt;

        public BestellungProduktEntry(Bestellung bestellung, BestellungProdukt produkt) {
            this.bestellung = bestellung;
            this.produkt = produkt;
        }
    }

    public BestellungTableModel(List<Bestellung> data) {
        this.entries = new ArrayList<>();
        // Für jede Bestellung alle BestellungProdukt-Einträge hinzufügen
        for (Bestellung bestellung : data) {
            for (BestellungProdukt produkt : bestellung.getProdukte()) {
                entries.add(new BestellungProduktEntry(bestellung, produkt));
            }
        }
    }

    @Override
    public int getRowCount() {
        return entries.size();
    }

    @Override
    public int getColumnCount() {
        return columnNames.length;
    }

    @Override
    public Object getValueAt(int rowIndex, int columnIndex) {
        BestellungProduktEntry entry = entries.get(rowIndex);
        Bestellung bestellung = entry.bestellung;
        BestellungProdukt produkt = entry.produkt;
        switch (columnIndex) {
            case 0: return bestellung.getId();
            case 1: return bestellung.getKunde().getId();
            case 2: return produkt.getProdukt().getId();
            case 3: return produkt.getProdukt().getName();
            case 4: return produkt.getAnzahl();
            case 5: return bestellung.getDatum();
            default: return null;
        }
    }

    @Override
    public String getColumnName(int column) {
        return columnNames[column];
    }

    @Override
    public Class<?> getColumnClass(int columnIndex) {
        switch (columnIndex) {
            case 0: case 1: case 2: return Integer.class; // ID, Kunde ID, Produkt ID
            case 3: return String.class;                  // Produktname
            case 4: return Integer.class;                // Menge (anzahl)
            case 5: return java.util.Date.class;         // Datum
            default: return Object.class;
        }
    }
    
}